# 手術室シフト表作成システム

看護師のシフト希望調査結果から、公平な2交代制の手術室シフト表を自動生成するWebアプリケーションです。

## 機能

- **希望データの読み込み**: CSV形式のシフト希望調査結果を読み込み
- **公平なシフト割り当て**: 以下の公平性を考慮した自動割り当て
  - 夜勤回数の公平性（夜勤可能な人の中で）
  - 勤務日数の公平性
  - 週末（土日）の休日の公平性
  - 希望休みの尊重
  - 有給消化の優先（備考欄の情報を考慮）
- **統計情報の表示**: 看護師ごとの勤務状況を統計で確認
- **CSVエクスポート**: 生成したシフト表をCSV形式でダウンロード

## 使い方

1. `index.html`をブラウザで開く
2. 「データを読み込む」ボタンをクリック
   - ファイル選択ダイアログでCSVファイルを選択するか、デフォルトの`data/shift_requests.csv`が読み込まれます
3. シフト設定を調整
   - **日勤必要人数**: 1日の日勤に必要な看護師の人数（デフォルト: 3名）
   - **夜勤必要人数**: 1日の夜勤に必要な看護師の人数（デフォルト: 2名）
   - **1ヶ月の目標勤務日数**: 看護師1人あたりの目標勤務日数（デフォルト: 20日）
4. 「シフト表を生成」ボタンをクリック
5. 生成されたシフト表と統計情報を確認
6. 「CSVでエクスポート」ボタンでシフト表をダウンロード

## データ形式

CSVファイルは以下の形式である必要があります：

- 1列目: `氏名`（看護師の名前）
- 2列目: `シフト希望期間`
- 3列目: `備考`（有給、旅行予定、通院など）
- 4列目以降: 日付列（例: `8/1`, `8/2`, ..., `8/31`）

各日付列の値：
- `希望なし（終日勤務可能）`: 日勤・夜勤どちらも可能
- `日勤不可`: 日勤のみ不可
- `夜勤不可`: 夜勤のみ不可
- `終日不可`: その日は勤務不可

## 公平性の指標

システムは以下の指標で公平性を評価・最適化します：

1. **勤務日数**: 全員が目標勤務日数に近くなるように調整
2. **夜勤回数**: 夜勤可能な看護師間で夜勤回数を均等化
3. **週末休日**: 土日の休日をできるだけ公平に分配
4. **希望違反**: できるだけ希望を尊重し、違反を最小化
5. **優先事項**: 備考欄に「有給」「旅行」「通院」などがある場合は優先的に希望を尊重

## ファイル構成

```
shift_generator/
├── index.html              # メインHTMLファイル
├── script.js               # シフト生成ロジック
├── data/
│   └── shift_requests.csv  # シフト希望データ（デフォルト）
└── README.md               # このファイル
```

## 技術スタック

- 純粋なJavaScript（ES6+）
- PapaParse（CSV解析ライブラリ）
- レスポンシブデザイン対応

## 注意事項

- シフト表の生成は最適化アルゴリズムを使用していますが、完全に最適解を保証するものではありません
- 希望違反がある場合は、シフト表上で赤色で表示されます
- 週末（土日）は太字で表示されます
- 必要人数が看護師数に対して多すぎる場合、希望違反が発生する可能性があります
